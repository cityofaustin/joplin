{% load joplin_tags %}

<!-- Modal -->
<div class="modal fade" id="createNewContentModal" tabindex="-1" role="dialog" aria-labelledby="createNewContentModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="js-wizard-step content-modal__step--active" data-active="true">
          <h2>Select the Content Type</h2>
          <div class="button js-page-select" data-content-type="service">Service Page</div>
          <div class="button js-page-select" data-content-type="process">Process Page</div>
          <div class="button js-page-select" data-content-type="department">Department Page</div>
        </div>

        <div class="js-wizard-step content-modal__step--inactive" data-active="false">
          <h2>Select the Content Type</h2>
          <small>Character limit: 54</small>
          <label for="page-title">Page Title</label>
          <input type="text" id="page-title">
          <small>Example: Drop off hazardous wastes and other recyclables</small>
          <ul>
            <li>Use simple, accessible language</li>
            <li>Use words you think residents may search to find the service</li>
            <li>You don’t need to worry about including your department’s name in the title</li>
          </ul>

          <div class="modal-button-row">
            <div class="button js-back">Back</div>
            <button type="button" class="button" data-dismiss="modal">Close</button>
            <div class="button js-continue">Continue</div>
          </div>
        </div>

      </div>
        <div class="js-wizard-step content-modal__step--inactive" data-active="false">
          <h2>Select the topic  which best fits your content.</h2>
          <form action="">
            <input type="radio" id="test1" name="topic" value="test1">
            <label for="test1">Test 1</label>
          </form>
          {% topics %}
          <ul>
            {% for topic in topics %}
              {{ topics }}
            <li>{{topic.text}}</li>
            {% endfor %}
          </ul>
          <div class="modal-button-row">
            <div class="button js-back">Back</div>
            <button type="button" class="button" data-dismiss="modal">Close</button>
            <div class="button js-continue">Continue</div>
          </div>
        </div>


      </div>
      <!-- <div class="modal-footer">
        <button type="button" class="btn btn-primary">Save changes</button>
      </div> -->
    </div>
  </div>
</div>

<script>
  $(document).ready(function() {

    var contentWizardState = {
      type: '',
      title: '',
      topic: '',
      activeStep: 0,
    }

    var contentWizardModule = {
      init: function() {
        console.log('setup contentWizardModule...')
        this.registerEventHandlers()
      },
      registerEventHandlers: function() {
        var thiz = this
        console.log(this)

        $('.js-page-select').click( function() {
          contentWizardState.type = $(this).data('contentType');
          thiz.incrementActiveStep();
          console.log(contentWizardState);
        });

        $('.js-back').click( function(e) {
          e.preventDefault()
          console.log('js-back', contentWizardState);
          thiz.decrementActiveStep();
        });

        $('.js-continue').click( function(e) {
          debugger
          thiz.incrementActiveStep();
        });
      },
      selectClickHandler: function(thing) {
      },
      // renderVisibleStep: function(index) {
      //   debugger
      //
      // },
      incrementActiveStep: function(){
        contentWizardState.activeStep++
        $('.js-wizard-step').each( function(i) {
          if (contentWizardState.activeStep === i) {
            $(this).addClass('content-modal__step--active');
            $(this).removeClass('content-modal__step--inactive');
          } else {
            $(this).removeClass('content-modal__step--active');
            $(this).addClass('content-modal__step--inactive');
          }
        });
      },
      decrementActiveStep: function(){
        contentWizardState.activeStep--
        debugger
        $('.js-wizard-step').each( function(i) {
          if (contentWizardState.activeStep === i) {
            $(this).addClass('content-modal__step--active');
            $(this).removeClass('content-modal__step--inactive');
          } else {
            $(this).removeClass('content-modal__step--active');
            $(this).addClass('content-modal__step--inactive');
          }
        });
      },
     }

    contentWizardModule.init()
    // contentWizardModule.registerEventHandlers()
    console.log(contentWizardState)


  })
</script>
